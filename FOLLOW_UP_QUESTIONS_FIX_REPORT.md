# üîß –û—Ç—á—ë—Ç: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ "–ü–æ–º–æ—â—å"

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞–≤–∞—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ—Å–ª–µ workflow
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç workflow (deepresearch, composition_analysis, training_program, nutrition_plan) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ –∑–∞–¥–∞—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞.

**–ü—Ä–∏—á–∏–Ω–∞**: –ö–æ–Ω—Ç–µ–∫—Å—Ç (`userWorkflowContext`) –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è workflow.

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤–æ –≤—Å–µ—Ö 4 workflow:

#### ‚úÖ DeepResearch (—Å—Ç—Ä–æ–∫–∞ 1635)
```javascript
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
userWorkflowContext.set(user.id, {
  lastResponse: result.response,
  timestamp: Date.now()
});
```

#### ‚úÖ Composition Analysis (—Å—Ç—Ä–æ–∫–∞ 1686)
```javascript
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
userWorkflowContext.set(user.id, {
  lastResponse: result.response,
  timestamp: Date.now()
});
```

#### ‚úÖ Training Program - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Å—Ç—Ä–æ–∫–∞ 282)
```javascript
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
userWorkflowContext.set(user.id, {
  lastResponse: result.message,
  timestamp: Date.now()
});
```

#### ‚úÖ Training Program - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ workflow (—Å—Ç—Ä–æ–∫–∞ 1762)
```javascript
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
userWorkflowContext.set(user.id, {
  lastResponse: result.message,
  timestamp: Date.now()
});
```

#### ‚úÖ Nutrition Plan - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Å—Ç—Ä–æ–∫–∞ 384)
```javascript
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
userWorkflowContext.set(user.id, {
  lastResponse: result.message,
  timestamp: Date.now()
});
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
1. –ü–æ—Å–ª–µ –ª—é–±–æ–≥–æ workflow –æ—Ç–≤–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `userWorkflowContext`
2. –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞—ë—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—Å—Ç—Ä–æ–∫–∞ 1797)
3. –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –µ—Å—Ç—å, –≤–æ–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ Coze API —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞:
```javascript
messageWithContext = `–ö–û–ù–¢–ï–ö–°–¢ –ü–†–ï–î–´–î–£–©–ï–ì–û –†–ê–ó–ì–û–í–û–†–ê:
${workflowContext.lastResponse}

–£–¢–û–ß–ù–Ø–Æ–©–ò–ô –í–û–ü–†–û–° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø: ${text}

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–≤–µ—Ç—å –Ω–∞ —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.`;
```

---

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "‚ùì –ü–æ–º–æ—â—å"
**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–Ω–æ–ø–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞, –Ω–æ Telegram –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É:
```
ETELEGRAM: 400 Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 1310
```

**–ü—Ä–∏—á–∏–Ω–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–≤–æ–π–Ω—ã–µ –∑–≤—ë–∑–¥–æ—á–∫–∏ `**—Ç–µ–∫—Å—Ç**` (bold –≤ Markdown v2), –Ω–æ Telegram Bot API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ `*—Ç–µ–∫—Å—Ç*` –≤ —Ä–µ–∂–∏–º–µ Markdown.

**–†–µ—à–µ–Ω–∏–µ**: –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `**` –Ω–∞ `*` –≤ —Ç–µ–∫—Å—Ç–µ –ø–æ–º–æ—â–∏ (—Å—Ç—Ä–æ–∫–∞ 1268-1298).

#### –î–æ:
```markdown
‚ùì **–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é FitnessBotAI**
ü§ñ **–ò–ò-—Ç—Ä–µ–Ω–µ—Ä** - –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫...
```

#### –ü–æ—Å–ª–µ:
```markdown
‚ùì *–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é FitnessBotAI*
ü§ñ *–ò–ò-—Ç—Ä–µ–Ω–µ—Ä* - –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫...
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–æ —Å—Ç—Ä–æ–∫ | –î–æ–±–∞–≤–ª–µ–Ω–æ | –£–¥–∞–ª–µ–Ω–æ |
|------|----------------|-----------|---------|
| `src/bot/handlers.js` | 44 | +37 | -7 |

---

## üöÄ –ö–æ–º–º–∏—Ç—ã

1. **a0c2128** - "Fix: Add workflow context for follow-up questions + fix Help button Markdown"

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –£—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ—Å–ª–µ DeepResearch
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç "üî¨ –ì–ª—É–±–æ–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ"
2. –í–≤–æ–¥–∏—Ç –∑–∞–ø—Ä–æ—Å: "–ö—Ä–µ–∞—Ç–∏–Ω –º–æ–Ω–æ–≥–∏–¥—Ä–∞—Ç"
3. –ü–æ–ª—É—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
4. –ó–∞–¥–∞—ë—Ç —É—Ç–æ—á–Ω–µ–Ω–∏–µ: "–ê –∫–∞–∫–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞?"
5. ‚úÖ Coze API –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç —Å —É—á—ë—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –£—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ—Å–ª–µ Composition Analysis
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç "üß™ –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–∞–≤–∞ –¥–æ–±–∞–≤–∫–∏"
2. –í–≤–æ–¥–∏—Ç: "E621, E627, E631"
3. –ü–æ–ª—É—á–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–∞–≤–∞
4. –°–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "–ú–æ–∂–Ω–æ –ª–∏ –¥–µ—Ç—è–º?"
5. ‚úÖ Coze API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∞–Ω–∞–ª–∏–∑–∞ –∏ –¥–∞—ë—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –£—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ—Å–ª–µ Training Program
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
2. –ü–æ–ª—É—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω
3. –°–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "–ö–∞–∫ —á–∞—Å—Ç–æ –º–µ–Ω—è—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è?"
4. ‚úÖ Coze API —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –≤ –æ—Ç–≤–µ—Ç–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ö–Ω–æ–ø–∫–∞ "–ü–æ–º–æ—â—å"
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "‚ùì –ü–æ–º–æ—â—å"
2. ‚úÖ Telegram —É—Å–ø–µ—à–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø—Ä–∞–≤–∫—É –±–µ–∑ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–°—Ä–æ–∫ –∂–∏–∑–Ω–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**: –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º —É—Ç–æ—á–Ω—è—é—â–µ–º –≤–æ–ø—Ä–æ—Å–µ, –ø–æ–∑–≤–æ–ª—è—è –≤–µ—Å—Ç–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏–∞–ª–æ–≥.

2. **–û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**: –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏:
   - –ù–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "üîÑ –ù–æ–≤—ã–π –¥–∏–∞–ª–æ–≥"
   - –ù–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "‚ùì –ü–æ–º–æ—â—å"
   - –ó–∞–ø—É—Å–∫–µ –Ω–æ–≤–æ–≥–æ workflow

3. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –õ–æ–≥–∏–∫–∞ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö 4 —Ç–∏–ø–æ–≤ workflow:
   - DeepResearch
   - Composition Analysis
   - Training Program
   - Nutrition Plan

4. **Markdown**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∂–∏–º `parse_mode: 'Markdown'` —Å –æ–¥–∏–Ω–∞—Ä–Ω—ã–º–∏ –∑–≤—ë–∑–¥–æ—á–∫–∞–º–∏ `*` –¥–ª—è –∂–∏—Ä–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.

---

## ‚è≠Ô∏è –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ GitHub
2. ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –æ–ø–ª–∞—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –¥–µ–ø–ª–æ—è
3. ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ production –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
4. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook —Å —Ä–µ–∞–ª—å–Ω—ã–º –ø–ª–∞—Ç–µ–∂–æ–º

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é  
**–î–∞—Ç–∞**: 08.10.2025  
**–ö–æ–º–º–∏—Ç**: a0c2128
