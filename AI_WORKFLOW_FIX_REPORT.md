# ü§ñ –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ AI Workflow –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–î–∞—Ç–∞:** 8 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 2.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü—É—Å—Ç—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –≤–æ—Ä–∫—Ñ–ª–æ—É
**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –í—Å–µ AI-–≤–æ—Ä–∫—Ñ–ª–æ—É –≤—ã–∑—ã–≤–∞–ª–∏—Å—å —Å –ø—É—Å—Ç—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `{}`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–≤–æ–π –∑–∞–ø—Ä–æ—Å (—Ç–µ–º—É –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–∫–∏)
- –í–æ—Ä–∫—Ñ–ª–æ—É –ø–æ–ª—É—á–∞–ª–∏ `null` –∏–ª–∏ –ø—É—Å—Ç—ã–µ –æ–±—ä–µ–∫—Ç—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–æ—Ä–∫—Ñ–ª–æ—É (training_program, nutrition_plan) –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏ –∞–Ω–∫–µ—Ç—ã
- –§—É–Ω–∫—Ü–∏—è `continueInteractiveWorkflow` —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∞, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å
- –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–Ω–∫–µ—Ç—ã –æ—Ç AI, –±–æ—Ç –Ω–µ –º–æ–≥ –ø—Ä–∏–Ω—è—Ç—å –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üîß –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ `/deepresearch` (–ì–ª—É–±–æ–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ)

#### –ë—ã–ª–æ:
```javascript
const result = await runWorkflow(workflowId, {});
```

#### –°—Ç–∞–ª–æ:
```javascript
// –®–∞–≥ 1: –ó–∞–ø—Ä–æ—Å —Ç–µ–º—ã —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
userStates.set(user.id, { mode: 'awaiting_deepresearch_query' });
await bot.sendMessage(chatId, '–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è...');

// –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const result = await runWorkflow(workflowId, { query: userInput });
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç `/deepresearch`
2. –ë–æ—Ç –ø—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏ —Ç–µ–º—É –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ö–∞–∫ –∫—Ä–µ–∞—Ç–∏–Ω –≤–ª–∏—è–µ—Ç –Ω–∞ –Ω–∞–±–æ—Ä –º—ã—à–µ—á–Ω–æ–π –º–∞—Å—Å—ã?")
4. –ë–æ—Ç –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ—Ä–∫—Ñ–ª–æ—É —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `{ query: "–ö–∞–∫ –∫—Ä–µ–∞—Ç–∏–Ω..." }`
5. –ü–æ–ª—É—á–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ `/composition_analysis` (–ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–∞–≤–∞ –¥–æ–±–∞–≤–æ–∫)

#### –ë—ã–ª–æ:
```javascript
const result = await runWorkflow(workflowId, {});
```

#### –°—Ç–∞–ª–æ:
```javascript
// –®–∞–≥ 1: –ó–∞–ø—Ä–æ—Å –Ω–∞–∑–≤–∞–Ω–∏—è –¥–æ–±–∞–≤–∫–∏
userStates.set(user.id, { mode: 'awaiting_composition_query' });
await bot.sendMessage(chatId, '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞...');

// –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
const result = await runWorkflow(workflowId, { supplement: userInput });
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç `/composition_analysis`
2. –ë–æ—Ç –ø—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–∫–∏
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ö—Ä–µ–∞—Ç–∏–Ω –º–æ–Ω–æ–≥–∏–¥—Ä–∞—Ç")
4. –ë–æ—Ç –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ—Ä–∫—Ñ–ª–æ—É —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `{ supplement: "–ö—Ä–µ–∞—Ç–∏–Ω –º–æ–Ω–æ–≥–∏–¥—Ä–∞—Ç" }`
5. –ü–æ–ª—É—á–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–Ω–∞–ª–∏–∑

---

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ `/training_program` (–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫)

#### –ë—ã–ª–æ:
```javascript
const result = await runWorkflow(workflowId, {});
await bot.sendMessage(chatId, result.response); // ‚ùå response –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö
```

#### –°—Ç–∞–ª–æ:
```javascript
// –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–æ—Ä–∫—Ñ–ª–æ—É
const result = await runWorkflow(workflowId, {});

// –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
if (result.isInteractive && result.eventId) {
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º eventId –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞
  userStates.set(user.id, {
    mode: 'interactive_training_program',
    eventId: result.eventId,
    workflowType: 'training_program'
  });
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–Ω–∫–µ—Ç—É (–ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –æ—Ç AI)
  await bot.sendMessage(chatId, result.message, { reply_markup: { force_reply: true } });
}

// –®–∞–≥ 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –≤ —Ä–µ–∂–∏–º–µ interactive_training_program:
const continueResult = await continueInteractiveWorkflow(
  eventId,          // ID —Å–µ—Å—Å–∏–∏
  userAnswer,       // –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  'training_program',
  userId
);

// –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
if (continueResult.eventId && !continueResult.isComplete) {
  // –ï—â–µ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã - –æ–±–Ω–æ–≤–ª—è–µ–º eventId –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
  userStates.set(user.id, { ...state, eventId: continueResult.eventId });
  await bot.sendMessage(chatId, continueResult.message);
} else {
  // –î–∏–∞–ª–æ–≥ –∑–∞–≤–µ—Ä—à–µ–Ω - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
  await sendLongMessage(bot, chatId, continueResult.message, mainKeyboard);
}
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç `/training_program`
2. –í–æ—Ä–∫—Ñ–ª–æ—É –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –∞–Ω–∫–µ—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ö–∞–∫–æ–π —É –≤–∞—Å –æ–ø—ã—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫?")
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç ‚Üí –±–æ—Ç –≤—ã–∑—ã–≤–∞–µ—Ç `continueInteractiveWorkflow()`
4. –í–æ—Ä–∫—Ñ–ª–æ—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç
5. –¶–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –ø–æ–∫–∞ `isComplete = false`
6. –ö–æ–≥–¥–∞ `isComplete = true`, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫

---

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ `/nutrition_plan` (–ü–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è)

**–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ** `/training_program` - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–æ—Ä–∫—Ñ–ª–æ—É —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç `/nutrition_plan`
2. –í–æ—Ä–∫—Ñ–ª–æ—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–Ω–∫–µ—Ç—É (–≤–µ—Å, —Ü–µ–ª—å, –∞–ª–ª–µ—Ä–≥–∏–∏ –∏ —Ç.–¥.)
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç –∞–Ω–∫–µ—Ç—É, –æ—Ç–≤–µ—á–∞—è –Ω–∞ –∫–∞–∂–¥—ã–π –≤–æ–ø—Ä–æ—Å
4. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è

---

## üÜï –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. `sendLongMessage()` - –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
```javascript
async function sendLongMessage(bot, chatId, message, keyboard = null) {
  const maxLength = 4096;
  
  if (message.length <= maxLength) {
    await bot.sendMessage(chatId, message, { parse_mode: 'Markdown', ...keyboard });
  } else {
    // –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫
    const parts = [];
    let currentPart = '';
    const lines = message.split('\n');
    
    for (const line of lines) {
      if ((currentPart + line + '\n').length > maxLength) {
        if (currentPart) parts.push(currentPart);
        currentPart = line + '\n';
      } else {
        currentPart += line + '\n';
      }
    }
    if (currentPart) parts.push(currentPart);
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ —á–∞—Å—Ç–µ–π (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —á–∞—Å—Ç–∏)
    for (let i = 0; i < parts.length; i++) {
      const isLast = i === parts.length - 1;
      await bot.sendMessage(
        chatId, 
        parts[i], 
        isLast ? { parse_mode: 'Markdown', ...keyboard } : { parse_mode: 'Markdown' }
      );
    }
  }
}
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –í—Å–µ AI-–≤–æ—Ä–∫—Ñ–ª–æ—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç `sendLongMessage()` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ `bot.sendMessage()`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ >4096 —Å–∏–º–≤–æ–ª–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫

---

### 2. –ù–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (userStates)

#### –ü—Ä–æ—Å—Ç—ã–µ –≤–æ—Ä–∫—Ñ–ª–æ—É:
```javascript
{ mode: 'awaiting_deepresearch_query' }       // –û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ–º—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
{ mode: 'awaiting_composition_query' }        // –û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–æ–±–∞–≤–∫–∏
```

#### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–æ—Ä–∫—Ñ–ª–æ—É:
```javascript
{
  mode: 'interactive_training_program',       // –†–µ–∂–∏–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∫–µ—Ç—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
  eventId: '7479065104894935045',            // ID —Å–µ—Å—Å–∏–∏ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è
  workflowType: 'training_program'           // –¢–∏–ø –≤–æ—Ä–∫—Ñ–ª–æ—É
}

{
  mode: 'interactive_nutrition_plan',        // –†–µ–∂–∏–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∞–Ω–∫–µ—Ç—ã –ø–∏—Ç–∞–Ω–∏—è
  eventId: '7446893841430429701',
  workflowType: 'nutrition_plan'
}
```

---

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç Coze API

#### –ü—Ä–æ—Å—Ç—ã–µ –≤–æ—Ä–∫—Ñ–ª–æ—É (runSimpleWorkflow):
```javascript
{
  success: true,
  data: { output_final: "..." },
  response: "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ AI"  // ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
}
```

#### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–æ—Ä–∫—Ñ–ª–æ—É (runInteractiveWorkflow):
```javascript
// –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–∞–Ω–∫–µ—Ç–∞):
{
  success: true,
  message: "–í–æ–ø—Ä–æ—Å 1: –ö–∞–∫–æ–π —É –≤–∞—Å –æ–ø—ã—Ç?",  // ‚Üê –í–æ–ø—Ä–æ—Å –æ—Ç AI
  eventId: "session_12345",                // ‚Üê –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è
  isInteractive: true,
  isDone: false
}

// –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ continueInteractiveWorkflow:
{
  success: true,
  message: "–í–æ–ø—Ä–æ—Å 2: –°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤ –Ω–µ–¥–µ–ª—é –º–æ–∂–µ—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è?",
  eventId: "session_12346",  // ‚Üê –ù–æ–≤—ã–π eventId –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
  isComplete: false
}

// –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:
{
  success: true,
  message: "## –í–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫\n\n–î–µ–Ω—å 1: ...",
  eventId: null,
  isComplete: true  // ‚Üê –î–∏–∞–ª–æ–≥ –∑–∞–≤–µ—Ä—à–µ–Ω
}
```

---

## üîÑ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ì–ª—É–±–æ–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
```
User ‚Üí /deepresearch
Bot  ‚Üí "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è"
      (userStates: { mode: 'awaiting_deepresearch_query' })

User ‚Üí "–ö–∞–∫ –∫—Ä–µ–∞—Ç–∏–Ω –≤–ª–∏—è–µ—Ç –Ω–∞ –Ω–∞–±–æ—Ä –º—ã—à–µ—á–Ω–æ–π –º–∞—Å—Å—ã?"
Bot  ‚Üí "‚è≥ –ü—Ä–æ–≤–æ–∂—É –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑..."
       runWorkflow(DEEP_RESEARCH_ID, { query: "–ö–∞–∫ –∫—Ä–µ–∞—Ç–∏–Ω..." })
       sendLongMessage(—Ä–µ–∑—É–ª—å—Ç–∞—Ç)
       useFreeRequest() –∏–ª–∏ incrementRequestUsage()
       (userStates: —É–¥–∞–ª–µ–Ω–æ)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è)
```
User ‚Üí /training_program
Bot  ‚Üí "‚è≥ –ó–∞–ø—É—Å–∫–∞—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫..."
       runWorkflow(TRAINING_PROGRAM_ID, {})
       
Bot  ‚Üí "–í–æ–ø—Ä–æ—Å 1: –ö–∞–∫–æ–π —É –≤–∞—Å –æ–ø—ã—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫?"
      (userStates: { mode: 'interactive_training_program', eventId: 'xxx' })

User ‚Üí "–°—Ä–µ–¥–Ω–∏–π, —Ç—Ä–µ–Ω–∏—Ä—É—é—Å—å 2 –≥–æ–¥–∞"
Bot  ‚Üí continueInteractiveWorkflow('xxx', "–°—Ä–µ–¥–Ω–∏–π...", 'training_program')
       
Bot  ‚Üí "–í–æ–ø—Ä–æ—Å 2: –°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤ –Ω–µ–¥–µ–ª—é –º–æ–∂–µ—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è?"
      (userStates: –æ–±–Ω–æ–≤–ª–µ–Ω eventId)

User ‚Üí "4 –¥–Ω—è"
Bot  ‚Üí continueInteractiveWorkflow(...)

...–µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤...

Bot  ‚Üí "## –í–∞—à–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫\n\n–î–µ–Ω—å 1: ..."
       sendLongMessage(—Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞)
       useFreeRequest()
       (userStates: —É–¥–∞–ª–µ–Ω–æ)
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [x] `/deepresearch` - –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–µ–º—É –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
- [x] `/composition_analysis` - –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–∫–∏
- [x] `/training_program` - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∫–µ—Ç–∞
- [x] `/nutrition_plan` - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∫–µ—Ç–∞
- [x] –§—É–Ω–∫—Ü–∏—è `sendLongMessage()` –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–ª–∏–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π `awaiting_deepresearch_query`
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π `awaiting_composition_query`
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π `interactive_training_program`
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π `interactive_nutrition_plan`
- [x] –ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –≤–æ—Ä–∫—Ñ–ª–æ—É: `{ query: ... }`, `{ supplement: ... }`
- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `continueInteractiveWorkflow()` –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞
- [x] –°–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–æ—Ä–∫—Ñ–ª–æ—É
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ eventId –¥–ª—è –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤

---

## üß™ –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç 1: –ì–ª—É–±–æ–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
1. –ù–∞–∂–∞—Ç—å `/deepresearch`
2. –í–≤–µ—Å—Ç–∏ —Ç–µ–º—É: "–í–ª–∏—è–Ω–∏–µ –∫—Ä–µ–∞—Ç–∏–Ω–∞ –Ω–∞ –º—ã—à–µ—á–Ω—É—é –º–∞—Å—Å—É"
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –Ω–∞—É—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –ó–∞–ø—Ä–æ—Å —Å–ø–∏—Å–∞–ª—Å—è (6/7 –æ—Å—Ç–∞–ª–æ—Å—å)

### –¢–µ—Å—Ç 2: –ê–Ω–∞–ª–∏–∑ –¥–æ–±–∞–≤–∫–∏
1. –ù–∞–∂–∞—Ç—å `/composition_analysis`
2. –í–≤–µ—Å—Ç–∏: "BCAA"
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–∞–≤–∞, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –ó–∞–ø—Ä–æ—Å —Å–ø–∏—Å–∞–ª—Å—è (5/7 –æ—Å—Ç–∞–ª–æ—Å—å)

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è)
1. –ù–∞–∂–∞—Ç—å `/training_program`
2. –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –∞–Ω–∫–µ—Ç—ã (–æ–ø—ã—Ç, —á–∞—Å—Ç–æ—Ç–∞, —Ü–µ–ª–∏ –∏ —Ç.–¥.)
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** 
   - –ê–Ω–∫–µ—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (–≤–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç-–≤–æ–ø—Ä–æ—Å...)
   - –ó–∞–ø—Ä–æ—Å —Å–ø–∏—Å–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
   - –î–ª–∏–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Ä–∞–∑–±–∏—Ç –Ω–∞ —á–∞—Å—Ç–∏ (–µ—Å–ª–∏ >4096 —Å–∏–º–≤–æ–ª–æ–≤)

### –¢–µ—Å—Ç 4: –ü–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è)
1. –ù–∞–∂–∞—Ç—å `/nutrition_plan`
2. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∫–µ—Ç—É (–≤–µ—Å, —Ä–æ—Å—Ç, —Ü–µ–ª—å, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è)
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è —Å –º–µ–Ω—é
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

---

## üìå –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –≤–æ—Ä–∫—Ñ–ª–æ—É (deepresearch, composition_analysis):
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç `result.response` (–Ω–µ `result.message`)
- –°–ø–∏—Å—ã–≤–∞—é—Ç –∑–∞–ø—Ä–æ—Å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
- –ù–µ —Ç—Ä–µ–±—É—é—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –î–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ—Ä–∫—Ñ–ª–æ—É (training_program, nutrition_plan):
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç `result.message` (–Ω–µ `result.response`)
- –ü—Ä–æ–≤–µ—Ä—è—é—Ç `result.isInteractive` –∏ `result.eventId`
- –°–ø–∏—Å—ã–≤–∞—é—Ç –∑–∞–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ `isComplete = true`
- –°–æ—Ö—Ä–∞–Ω—è—é—Ç `eventId` –≤ userStates –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–æ—Ä–∫—Ñ–ª–æ—É:
- **deepresearch:** `{ query: "—Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞" }`
- **composition_analysis:** `{ supplement: "–Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–∫–∏" }`
- **training_program:** `{}` (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫), –∑–∞—Ç–µ–º —á–µ—Ä–µ–∑ `continueInteractiveWorkflow()`
- **nutrition_plan:** `{}` (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫), –∑–∞—Ç–µ–º —á–µ—Ä–µ–∑ `continueInteractiveWorkflow()`

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 4 –≤–æ—Ä–∫—Ñ–ª–æ—É
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏:** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –¥–æ—Å—Ç—É–ø –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è
4. **GitHub commit:** –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 8 –æ–∫—Ç—è–±—Ä—è 2025
