# 📈 Модуль анализа прогресса

## Описание

Комплексный модуль для анализа прогресса пользователя в фитнес-боте. Предоставляет детальную оценку достижений по всем аспектам фитнеса с персональными рекомендациями.

## Возможности

### 🎯 Анализ прогресса
- **Вес**: Тенденции изменения, процентный прогресс, частота измерений
- **Тренировки**: Частота, продолжительность, типы, активность
- **Цели**: Процент выполнения, статус достижения

### 📊 Система оценки
- **5 уровней**: Новичок 🌱 → Любитель 📈 → Атлет 🔥 → Профи 💪 → Мастер 🏆
- **Балл 0-100**: Комплексная оценка на основе всех параметров
- **Умное взвешивание**: Учитывает доступные данные пользователя

### 💡 Персональные рекомендации
- **3 уровня приоритета**: Высокий 🔴, Средний 🟡, Низкий 🟢
- **Адаптивность**: Рекомендации основаны на реальных данных
- **Мотивация**: Позитивные подкрепления при хорошем прогрессе

### 🏆 Система достижений
- **Постоянство**: За регулярное отслеживание данных
- **Активность**: За количество тренировок и времени
- **Целеустремленность**: За работу над целями
- **Серии**: За последовательные тренировки

## Использование

### Пользователь
1. Нажать **"🎯 Мои данные"** → **"📈 Прогресс"**
2. Дождаться анализа (индикатор загрузки)
3. Получить детальный отчет с рекомендациями

### Разработчик
```javascript
import { analyzeUserProgress, formatProgressReport } from './services/progress-analyzer.js';

// Анализ прогресса
const result = await analyzeUserProgress(telegramUserId);
if (result.success) {
  const report = formatProgressReport(result.data);
  console.log(report);
}
```

## Структура отчета

### 📈 Заголовок
- Приветствие с именем пользователя
- Количество дней в системе
- Общий балл и уровень

### ⚖️ Раздел "Вес"
- Текущий вес и изменения
- Процент изменения
- Количество записей и период
- Тенденция (📈/📉/➡️)

### 🏋️‍♂️ Раздел "Тренировки"
- Общее количество и частота
- Суммарное время тренировок
- Любимый тип тренировок

### 🎯 Раздел "Цели"
- Количество активных целей
- Количество выполненных
- Средний процент прогресса

### 🏆 Достижения
- Список заработанных значков
- Описание каждого достижения

### 💡 Рекомендации
- До 3 персональных советов
- Приоритизированы по важности
- Конкретные и выполнимые

## Алгоритмы

### Анализ веса
```javascript
// Тенденция за последние 30 дней
if (recentChange > 1) trend = 'increasing';
else if (recentChange < -1) trend = 'decreasing';
else trend = 'stable';
```

### Анализ тренировок
```javascript
// Частота тренировок в неделю
frequency = (totalWorkouts / totalDays * 7).toFixed(1);
```

### Общий балл
```javascript
// Весовые коэффициенты
- Отслеживание веса: 30%
- Активность тренировок: 40%
- Достижение целей: 30%
```

### Уровни
- **0-19**: Новичок 🌱
- **20-39**: Любитель 📈  
- **40-59**: Атлет 🔥
- **60-79**: Профи 💪
- **80-100**: Мастер 🏆

## Примеры

### Успешный пользователь
```
📈 ОТЧЕТ О ПРОГРЕССЕ

👋 Иван, вы с нами уже 45 дней!

🏆 Общая оценка: 78/100
🏅 Уровень: Профи

⚖️ ВЕС
• Текущий: 78.2 кг
• Изменение: -1.8 кг (-2.2%)
• Записей: 8 за 43 дня
• Тенденция: 📉

🏋️‍♂️ ТРЕНИРОВКИ
• Всего: 15 тренировок
• Частота: 2.5 раз/неделю
• Время: 12 часов суммарно
• Любимый тип: Силовая тренировка

🎯 ЦЕЛИ
• Активных целей: 1
• Выполнено: 0
• Средний прогресс: 65%

🏆 ДОСТИЖЕНИЯ
💪 Активный спортсмен
   Провели 15 тренировок
⚖️ Постоянство в отслеживании
   Записали вес 8 раз

💡 РЕКОМЕНДАЦИИ
🟡 Увеличьте частоту тренировок
   Для лучших результатов рекомендуется 3-4 тренировки в неделю.
```

### Начинающий пользователь
```
📈 ОТЧЕТ О ПРОГРЕССЕ

👋 Мария, вы с нами уже 5 дней!

🌱 Общая оценка: 15/100
🏅 Уровень: Новичок

⚖️ ВЕС
• Данных пока нет

🏋️‍♂️ ТРЕНИРОВКИ
• Всего: 2 тренировки
• Частота: 2.8 раз/неделю
• Время: 1 час суммарно
• Любимый тип: Кардио

🎯 ЦЕЛИ
• Целей пока не установлено

💡 РЕКОМЕНДАЦИИ
🔴 Начните отслеживать вес
   Регулярное взвешивание поможет контролировать прогресс.
🔴 Поставьте цель
   Четкие цели мотивируют и помогают отслеживать прогресс.
```

## Файлы

- `src/services/progress-analyzer.js` - Основной модуль
- `src/bot/handlers.js` - Обработчик кнопки "Прогресс"
- `test_progress_logic.js` - Тесты логики
- `test_progress_analyzer.js` - Интеграционные тесты

## Тестирование

```bash
# Тест логики с мок-данными
node test_progress_logic.js

# Тест интеграции (требует БД)
node test_progress_analyzer.js

# Тест всех обработчиков
node test_button_handlers.js
```
